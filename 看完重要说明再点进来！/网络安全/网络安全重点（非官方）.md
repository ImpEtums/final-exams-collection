**网络安全概念**

防止任何对数据进行未授权访问的措施，或者防止造成信息有意无意泄漏、破坏、丢失等问题的发生，让数据处于远离危险、免于威胁的状态或特性。

**安全的基本属性**

CIA：保密性（Confidentiality）完整性（Integrity）可用性（Availability）

除此之外还有可靠性（Reliability）、不可抵赖性（Non- repudiation）和可控性（Controllability）

**高级可持续威胁攻击（APT 攻击）**

APT 攻击不是一种新型的技术手段

**APT 攻击的特点**

隐蔽性、针对性、攻击手段丰富、攻击范围广、防范难度高、先进的、持久的、有效的

**网络不安全的原因**

- 自身缺点
- 开放性
- 黑客攻击

**网络攻击产生的原因**

用户使用的操作系统内在缺陷

用户使用的程序语言本身所具有的安全隐患

网络通信协议自身存在的或因配置不当而产生的安全漏洞

**网络攻击的一般步骤（用具体例子阐述）**

- 预攻击探测
  - 收集信息，如 OS 类型，提供的服务端口
- 发现漏洞，采取攻击行为
  - 破解口令文件，或利用缓存溢出漏洞
- 获取攻击目标的控制权系统
  - 获取系统账号权限，并提升为 root 权限
- 安装系统后门
  - 方便以后使用
- 继续渗透网络，直至获取机密数据
  - 以此主机为跳板，寻找其他主机的漏洞
- 消灭踪迹
  - 消除所有入侵脚印，以免被管理员发觉

探测——渗透——驻留——传播——瘫痪

**网络攻击的分类**

- 主动攻击
  - 攻击者试图突破网络的安全防线，通过对数据流的修改或创建错误信息流，例如假冒、重放、欺骗、消息篡改、拒绝服务等
- 被动攻击
  - 攻击者简单地监听所有信息流以获得某些秘密
- 本地攻击
- 中间人攻击

欺骗类攻击

**常见的网络攻击手段**

- 探测类攻击
  - 主要包括：扫描技术、体系结构刺探、系统信息服务收集等
- 控制类攻击
  - 口令攻击、特洛伊木马、缓冲区溢出攻击
- 阻塞类攻击
  - 拒绝服务攻击（DoS）、TCP SYN 洪泛攻击、Land 攻击、 Smurf 攻击、电子邮件炸弹等
- 漏洞类攻击
  - 漏洞也叫脆弱性，指计算机系统在硬件、软件、协议的具体事项或系统安全策略上存在缺陷和不足
- 欺骗类攻击
  - ARP 缓存虚构、DNS 高速缓存污染、伪造电子邮件等
- 破坏类攻击
  - 计算机病毒、逻辑炸弹等攻击手段

**OSI 安全体系结构的5类安全服务**

机密性、完整性、访问控制、不可否认性、认证

**安全模型**

PDRR 模型

- 保护（Protection）

- 检测（Detection）

- 响应（Reaction）
- 恢复（Restore）

**端口扫描的原理**

端口扫描是向目标主机的 TCP 或 UDP 端口发送探测数据包，随机记录目标主机的响应。通过分析目标主机的响应来判断服务端口是打开还是关闭的，据此判断目标主机端口提供的服务或信息。

**网络扫描的类型**

- 主机扫描
  - 找出网段内活跃主机
- 端口扫描
  - 找出主机上所开放的网络服务
- 操作系统/网络服务辨识
  - 识别主机安装的操作系统类型与开放网络服务类型，以选择不同渗透攻击代码及配置
- 漏洞扫描
  - 找出主机/网络服务上所存在的安全漏洞，作为破解通道

**网络嗅探的原理**

以太网络的工作原理：采用载波侦听/冲突检测（CSMA/CD）技术，由于使用了广播机制，所有与网络连接的工作站都可以看到网络上传输的数据。

载波侦听/冲突检测（CSMA/CD）技术

载波侦听：在网络中的每个站点都具有同等的权利，在传输自己的数据时，首先监听信道是否空闲，如果空闲，就传输自己的数据，如果信道被占用，就等待信道空闲

冲突检测是为了防止发生两个站点同时监测到网络没有被使用时而产生冲突

**网卡接收模式**

- 单一模式
  - 只接收数据帧中目的地址是本机 MAC 地址的数据帧
- 广播模式
  - 能够接收网络中的广播信息
- 组播模式
  - 能够接收组播数据
- 混杂模式
  - 能够接收一切通过它的数据，而不管数据是否是传给它的

**MAC 泛洪**

交换机要维护一张 MAC 地址与端口的映射表（CAM）

维护该表的内存有限，如用大量的错误 MAC 地址的数据帧对交换机进行攻击，交换机就可能出现溢出

交换机就回到广播方式——向所有端口发送数据包（ARP 过载，MAC 泛洪）

**ARP 欺骗**

计算机维护一个 IP-MAC 地址对应表，该表随 ARP 请求/响应不断更新

ARP 欺骗就是改变表里的对应关系，攻击者成为被攻击者与交换机之间的中间人，使交换式局域网中的所有数据包都流经攻击者的网卡

**彩虹表**

彩虹表是一些表，它可以是指定字符的各种组合以及这些组合经过 MD5 或 LM 或 NTLM 等加密手段加密后的对照表，所以可想而知，这些表是相当庞大的，当得到这些表后，破解 hash 密码实际上相当于字典破解了，速度相对普通的暴力破解会大大增加

但是由于哈希算法的不可逆，所以暴力破解对于复杂密码破解不了，所以彩虹表能有效解决这难题

**弱口令**

容易被别人猜测到或被破解工具破解的口令

**强口令**

较为安全的口令应该不容易被发现规律，并且有足够的长度

对长度的要求随应用环境的不同而不同，应该是攻击者在某个时间段内很难破解

**不同操作系统口令存储的位置**

Windows：`C:\\Windows\\system32\\config`

Linux：`etc/passwd`

**欺骗攻击**

欺骗就是冒充身份通过认证以骗取信任的攻击方式，攻击者针对认证机制的缺陷，将自己伪装成可信任方，从而与受害者交流，以获取信息或者展开进一步攻击

**常见的欺骗攻击**

- IP 欺骗
  - IP 源地址欺骗就是攻击者伪造具有虚假源地址的 IP 数据包进行发送，目的是为了隐藏发送者身份，假冒其他计算机
  - IP 欺骗的方式
    - 简单的 IP 地址更换
    - 源路由攻击
    - TCP 会话劫持
  - IP 源地址欺骗原理
    - IPv4 的协议机制中以 IP 地址为信任基础，即当网络上两台计算机进行通信时，只要 IP 地址是正确的，通信双方则认为对方是可信的
    - 通过猜测 TCP 三次握手中所需的信息，假冒 IP 建立起 TCP 连接
  - IP 欺骗攻击的步骤（假设 A 是攻击者，B 是受信任的主机，C 是目标服务器）
    - A 让 B 失去工作能力
    - A 使用一些方法猜测出 C 的 ISN
    - A 用 B 的源地址向 C 请求连接
    - A 等待 C 发送 SYN + ACK 包发给 B
    - A 再次伪装成 B 向 C 发送带有 ISN 的ACK
    - 连接建立
  - IP 欺骗的防御
    - 入口过滤：不允许任何从外面进入网络的数据包使用单位内部地址作为源地址
    - 出口过滤：从内网主机到内网主机的流量不允许流到本网络之外
    - 防范源路由欺骗
    - 防范会话劫持
- ARP（地址解析协议）欺骗
  - ARP 协议根据目标主机的 IP 地址解析成 MAC 地址，并将解析过的 IP 地址和 MAC 地址的对应关系保存在地址 ARP 缓存中
  - 现象
    - 网络掉线但网络连接正常
    - 内网的部分 PC 机不能上网，或者所有电脑不能上网
    - 无法打开网页或打开网页慢
    - 局域网时断时续并且网速较慢
  - 缺陷
    - 主机收到应答包后不验证自己是否发送过对应的 ARP 请求
    - 主机收到应答包后不验证该回应包是否可信
    - 主机收到应答包后直接用应答包里的信息替换 ARP 缓存表中的原有信息
  - 原理
    - ARP 欺骗就是利用 ARP 协议的安全漏洞，通过向目标主机发送伪造的 ARP 请求或应答报文，使目标主机将数据报文发送到攻击者指定的计算机上去
  - 防范
    - MAC 地址静态绑定
    - 网关关闭 ARP 动态刷新的过程，使用静态路由，使得攻击者无法用 ARP 欺骗攻击网关
    - 通过划分 VLAN 和交换机端口绑定，细致地划分 VLAN，减少广播域的范围，使 ARP 在小范围内起作用，而不至于发生大面积影响
- ICMP 欺骗
  - ICMP 重定向攻击
    - 是指攻击者伪造网关向特定主机发送 ICMP 重定向报文，从而达到监听数据，篡改数据的目的
- 电子邮件欺骗
- DNS 欺骗
  - 局限性
    - 攻击者不能替换缓存中已经存在的记录
    - DNS 服务器存在缓存刷新时间问题
  - 防御
    - 使用最新版本 DNS 服务器软件并及时安装补丁
    - 关闭 DNS 服务器的递归功能
    - 限制区域传送范围
    - 限制动态更新
    - 采用分层的 DNS 体系结构
- Web 欺骗

**缓冲区溢出攻击**

缓冲区攻击就是向缓冲区中填入过多的数据，超出边界导致数据外溢，覆盖了相邻的内存空间，造成缓冲区溢出

缓冲区溢出成为远程攻击主要方式的原因在于，缓冲区溢出漏洞给予攻击者控制程序执行流程的机会

缓冲区溢出攻击的危害：

- 应用程序异常
- 系统不稳定甚至崩溃，干扰系统运行，导致系统宕机
- 改变程序执行流程，获得系统特权，执行恶意代码

缓冲区溢出攻击的特点：

- 与其他的攻击类型相比，缓冲区溢出不需要太多的先决条件，杀伤力很强，技术性强
- 缓冲区溢出比其它一些黑客攻击手段更具有破坏力和隐蔽性，这也是利用缓冲区溢出漏洞进行攻击日益普遍的原因

缓冲区溢出攻击的根本原因：现代计算机基础架构-冯诺依曼体系的安全缺陷，即程序的数据和指令都在同一内存中进行存储

**XSS 跨站脚本攻击**

跨站脚本是一种针对网站应用程序的安全漏洞攻击技术，是代码注入的一种

恶意攻击者往 Web 页面里注入恶意 Script 代码，当用户浏览这些网页时，就会执行其中的代码

XSS 的攻击目标是浏览器端程序

XSS 的攻击方式是身份窃取，盗取 cookie 信息，会话劫持，蠕虫以及钓鱼

XSS 根据效果不同可以分成三类

- 反射型 XSS
- 存储型 XSS
- DOM XSS

XSS 的危害

- 窃取用户 cookie
- DDos 攻击
- 网页挂马
- 提升用户权限
- 获取客户端信息
- 传播跨站脚本蠕虫
- 劫持用户会话
- 强制弹出广告页面、刷流量
- 任意篡改页面信息、删除文章

**SQL 注入攻击**

定义：攻击者利用设计上的漏洞，将 SQL 命令插入到 Web 表单提交或输入域名或页面请求的查询字符串，最终欺骗服务器执行恶意的 SQL 命令

攻击对象：服务器端的数据库

产生原因

- SQL 语句被拼接
- 转义字符处理不当
- 后台查询语句处理不当
- 动态生成 SQL 语句时没有对用户输入的数据进行验证

防范 SQL 注入攻击

- 严格的数据类型
- 特殊字符转义
- 使用预编译语句
- 框架技术
- 存储过程

**文件上传漏洞攻击**

攻击目标：服务器端程序

产生原因

- 对于上传文件的 MIMETYPE 没有做检查
- 对于上传文件的后缀名没有做较为严格的限制
- 权限上没有对于上传的文件目录设置不可执行权限
- 对于 web server 上传文件或者指定目录的行为没有做限制

防范方法

- 客户端检测
  - 客户端使用 JS 检测，在文件未上传时，就对文件进行验证
- 服务器端检测
  - 检测文件的 MIME 类型，文件拓展名是否合法，或检测文件中师傅哦嵌入恶意代码
- 过滤名单
  - 白名单于黑名单扩展名过滤，文件类型检测，文件重命名等操作

**CSRF 跨站请求伪造攻击**

攻击者利用回话机制的漏洞，引导用户单击恶意网站，其中的恶意代码欺骗用户的浏览器去访问一个曾经认证过的网站并运行一些操作而引发攻击

攻击结果：冒充用户执行特定操作

攻击原理：利用 Web 中用户身份验证的漏洞，简单的身份验证只能保证请求发自某个用户的浏览器，却不能保证请求本身是用户自愿发出的

白话理解：攻击者盗用了你的身份，以你的名义进行某些非法操作，CSRF 能够使用你的账户发送邮件，获取你的敏感信息，甚至盗走你的财产

防范方法

- 验证 Referer
- 验证码
- Token
- Cookie 保护

**恶意代码**

长期存在的原因

- 计算机技术飞速发展的同时并未使系统的安全性得到增强，计算机技术进步带来的安全增强能力最多只能弥补由应用环境的复杂性带来的安全威胁的增长程度，不但如此，计算机新技术的出现还很有可能使计算机系统的安全变得比以往更加脆弱

恶意代码的分类

- 特洛伊木马
- 计算机病毒
- 后门程序
- 蠕虫
- 病菌
- 逻辑炸弹
- 核心级 RootKit
- 用户级 RootKit

有自我复制功能的恶意代码

- 蠕虫
- 病菌
- 病毒

没有自我复制功能的恶意代码

- 特洛伊木马
- 逻辑炸弹
- 后门

不需要宿主的恶意代码

- 蠕虫
- 病菌

需要宿主的恶意代码

- 病毒
- 特洛伊木马
- 逻辑炸弹
- 后门

**计算机病毒**

定义：凡能够引起计算机故障，破坏计算机数据的程序统称为计算机病毒

特性

- 传染性
- 寄生性
- 隐蔽性
- 潜伏性
- 可触发性
- 破坏性

计算机病毒程序一般包括以下三个功能模块

- 引导模块
- 传染模块
- 破坏模块

病毒技术

- 寄生技术
- 驻留技术
- 加密变形技术
- 隐藏技术

**特洛伊木马**

定义：是指寄宿在计算机内的一种非授权远程控制程序，是把自己伪装在正常程序内部的非法病毒程序，隐藏在系统中用以完成未授权功能，它原本属于一类基于远程控制的工具

具有欺骗、隐蔽、伪装性强和信息窃取的特点

带有黑客性质，有强大的控制和破坏能力，可窃取密码、控制系统、操作文件等

通常使用户很难判断它到底是合法程序还是木马

病毒具有感染性而木马不具有感染性

**蠕虫**

蠕虫的传播无需人为干预，并可通过网络进行自我复制，在复制过程中可能有改动

传播不必通过主机程序或文件，因此它可以潜入用户的系统并允许其他用户或程序远程操控由蠕虫感染的计算机

不使用驻留文件即可在系统间复制自身，而病毒需要传播受感染的驻留文件，通常蠕虫将发布其中已包含蠕虫宏的文档，这样整个文档将在计算机之间传播，应将整个文档视为蠕虫

**僵尸网络**

定义：Botnet 是指采用一种或多种传播手段，将大量主机感染 bot 程序病毒，从而在控制者和被感染主机之间所形成的一个可一对多控制的网络

**恶意代码的检测与防范**

- 静态分析方法
  - 基于代码特征的分析方法
  - 基于代码语义的分析方法
- 动态分析方法
  - 外部观察法
  - 跟踪调试法
- 基于网络的恶意代码检测方法
  - 基于 GRIDS 的恶意代码检测
  - 校验和
  - 沙箱技术
  - 基于 HoneyPot 的检测防御

**拒绝服务攻击**

Deny of Service（DoS）

网络信息系统由于某种原因不能为授权用户提供正常服务

造成 DoS 的攻击行为被称为 DoS 攻击，是指阻止或者拒绝合法使用者存取网络服务器的一种破坏性攻击方式

DoS 攻击类型（按照攻击行为划分）

- 网络带宽攻击
- 连通性攻击

DoS 攻击类型（按照攻击方式划分）

- 泛洪攻击
- 畸形报文攻击
- 扫描探测类攻击

典型的拒绝服务攻击

- 死亡之 Ping
  - ICMP 数据包的尺寸超过64KB 上限时，主机就会出现内存分配错误，导致 TCP/IP 堆栈崩溃，致使主机死机
- 泪滴（Teardrop）
  - 分片攻击，利用 TCP/IP 协议缺陷，首个实现攻击的程序名为 Teardrop
  - 如果传输的数据无法在一个报文中传输完成，就会被分片，传送到目标主机后再到堆栈中进行重组，该过程被称为分片
  - 为能够进行数据重组，TCP 首部包含——分片识别号、偏移量、数据长度、标志位，目标主机据此将各分片重组还原
  - 原理：向被攻击者发送多个分片的 IP 包，某些操作系统收到含有重叠便宜的伪造分片数据包时将会出现系统崩溃、重启等现象
- 泛洪类
  - UDP 泛洪
  - SYN 泛洪
  - ACK 泛洪
  - Connection 泛洪
  - HTTP Get 泛洪
- 利用 ICMP 协议攻击
  - ICMP Ping 淹没攻击，大量的 Ping 信息广播淹没目标系统，使得它不能够对合法的通信做出响应
  - ICMP nuke 攻击，也称为核弹攻击，是指发送目标操作系统无法处理的信息数据包，从而导致该系统瘫痪
  - ICMP 重定向攻击
- Land 攻击
  - 向目标主机发送大量的源地址和目标地址相同的包，造成目标主机解析时占用大量的系统资源，从而使网络功能完全瘫痪
  - 白话：我跟我自己连接
- Smurf 攻击
  - 利用 IP 欺骗和 ICMP 回应包引起目标主机网络阻塞，构造数据包时，令源地址=>被攻击主机地址，目的地址=>广播地址
  - 白话：大晚上我去敲响所有邻居家的门，告诉他们我是xx房间号的，结果所有邻居都去那个xx房间号骂人
- Fraggle 攻击
- 畸形消息攻击
- Slashdot effect
- WinNuke 攻击

**分布式拒绝服务攻击 DDoS**

DDoS 软件一般分为客户端、服务端与守护程序，这些程序可以协调分散在各处的机器共同完成对一台主机的攻击

- 客户端（攻击控制台）
  - 发起攻击的主机
- （攻击）服务端
  - 接收客户端发来的控制命令
- 守护程序（攻击器、攻击代理）
  - 直接（如 SYN Flooding）或间接（如反射式 DDoS）与攻击目标进行通信

**防火墙**

是一种用来加强网络之间访问控制的特殊网络互连设备，是一种非常有效的网络安全模型

核心思想是在不安全的国际网环境中构造一个相对安全的子网环境

目的是为了在被保护的内部网与不安全的非信任网络之间设置唯一的通道，以按照事先制定的策略控制信息的流入和流出，监督和控制使用者的操作

本质特征是隔离内外网络和对进出信息流实施访问控制，隔离方法可以使基于物理的，也可以使基于逻辑的

防火墙的迭代

- 第一代：基于路由器的防火墙
  - 称为包过滤防火墙，其特征：
    - 以访问控制表方式实现分组过滤
    - 过滤的依据是 IP 地址、端口号和其他网络特征
    - 只有分组过滤功能，且防火墙与路由器一体
  - 缺点
    - 路由协议本身具有安全漏洞
    - 路由器上的分组过滤规则的设置和配置复杂
    - 攻击者可假冒地址
    - 本质缺陷：一对矛盾，防火墙的设置会大大降低路由器的性能
      - 路由器：为网络访问提供动态灵活的路由
      - 防火墙：对访问行为实施静态固定的控制
- 第二代：用户化的防火墙工具套件
  - 特征：
    - 将过滤功能从路由器中独立出来，并加上审计和告警功能
    - 针对用户需求提供模块化的软件包
    - 安全性提高，价格降低
    - 纯软件产品，实现维护复杂
  - 缺点
    - 配置和维护过程复杂费时
    - 对用户技术要求高
    - 全软件实现，安全性和处理速度均有局限
- 第三代：建立在通用操作系统上
  - 特征：
    - 包括分组过滤或借用路由器的分组过滤功能
    - 装有专用的代理系系统，监控所有协议的数据和指令
    - 保护用户编程空间和用户可配置内核参数的设置
    - 安全性和速度大为提高
  - 实现方式
    - 软件、硬件、软硬结合
  - 问题
    - 作为基础的操作系统及其内核的安全性无从保证
    - 通用操作系统厂商不会对防火墙的安全性负责
    - 从本质上看，第三代防火墙既要防止来自外部网络的攻击，还要防止来自操作系统漏洞的攻击
    - 用户必须依赖两方面的安全支持：防火墙厂商和操作系统厂商
- 第四代：具有安全操作系统的防火墙
  - 防火墙厂商具有操作系统的源代码，并可实现安全内核
  - 对安全内核实现加固处理：即去掉不必要的系统特性，强化安全保护
  - 对每个服务器、子系统都做了安全处理
  - 在功能上包括了分组过滤，代理服务，且具有加密与鉴别功能
  - 透明性好，易于使用

智能防火墙与传统防火墙的比较

- 传统防火墙
  - 采用数据匹配检查技术
  - 边界防火墙
  - 缺陷
    - 结构性限制
    - 内部威胁
    - 效率和故障
- 智能防火墙
  - 采用人工智能识别技术
    - 优势
      - 安全、搞笑
    - 应用
      - 在保护网络和站点免受黑客攻击，阻断病毒的恶意传播，有效监控和管理内部局域网，保护必须的应用安全，提供强大的身份认证授权和审计管理等方面具有广泛的应用价值

分布式防火墙：一种新的防火墙体系结构

优势：在网络内部增加了另一层安全，有效抵御来自内部的攻击，消除网络边界上的通信瓶颈和单一故障点，支持基于加密和认证的网络应用，与拓扑无关，支持移动计算

