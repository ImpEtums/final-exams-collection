第一章：MATLAB操作基础
%%%%%%%%
实验指导
%%%%%%%%
一、实验目的
1.熟悉MATLAB的系统环境及基本操作方法。
略。

2.熟悉MATLAB的搜索路径及设置方法。
1）搜索路径
   A.检查命令对象是否为变量;
   B.检查命令对象是否为内部函数（MATLAB预定义的变量，如i和j）;
   C.检查命令对象是否为当前目录下的 .m文件;
   D.检查命令对象是否为MATLAB搜索路径下的其他.m文件;
2）设置方法
   主页-->设置路径-->添加文件夹 或 添加并包含子文件夹

3.熟悉MATLAB帮助信息的查阅方法。
help fun_name: help 函数名;
lookfor info: lookfor命令只对M文件的第一行进行关键字搜索;
lookfor -all info: lookfor -all命令对M文件全文进行关键字搜索;
info + Tab: 输入命令的前面几个字母，按 Tab键，系统自动列出以这几个字母开头的命令。

二、实验内容
1.建立工作文件夹，将工作文件夹设置到MATLAB搜索路径下。再实验用help命令。
略。

2.MATLAB的主要优点。
1）简单易学，允许用户以数学形式编写程序;
2）交互特性较强，用户在命令行窗口输入命令，即可得到计算结果;
3）短小搞笑的源代码;
4）强大的图形符号表达功能;
5）可扩展性强，主要体现在工具箱上;
6）丰富的内部函数;
7）支持多种操作系统;
9）可自动选择算法，比如内部函数，最佳算法在函数内部被自动选择。

3.利用MATLAB的帮助功能分别查询inv、plot、max、round等函数的功能及用法。
略。

4.完成下列操作。（基本函数和图形的表现）
略。

5.访问MathWorks公司主页，查询有关MATLAB产品信息。
略。

%%%%%%%%
思考练习
%%%%%%%%
一、填空题
1.MATLAB是（Matrix Laboratory）的缩写。

2.MATLAB的命令提示符是 （>>），表示MATLAB可以接收并执行所有输入的命令。在命令提示符的前面有一个按钮，单击该按钮可以快速查找MATLAB（函数）的功能。

3.MATLAB功能区提供了3个选项卡，分别是（主页）、（绘图）和（应用程序）。

4.设置MATLAB搜索路径有两种方法，一是用（Path）命令，二是在MATLAB“主页”选项卡的“环境”命令组中单击（设置路径）命令按钮或在命令行窗口执行（Pathtool）命令，在“设置路径”对话框中进行设置。

5.以下两个命令行的区别是（前一个命令完成变量赋值定义，并显示变量数值与命令行窗口；后一个命令也对变量进行赋值，但只显示变量x的值；而变量y的值，因以分号结束而不显示命令结果）。
  x = 10, y = -10
  x = 10, y = -10;

 二、问答题
 1.如何启动与退出MATLAB系统环境？
 略。
 
 2.简述MATLAB的主要功能。
 数值计算、符号计算、绘图、编程以及应用工具箱的扩展。
 
 3.如果一个MATLAB命令包含的字符较多，需要分成多行输入，该如何处理？
 使用续行符“...”将多行字符分成多行如：
 a = x+y+z...
 	b;
 	
 4.help命令和lookfor命令有何区别？
 help 命令针对的是函数，如 help abs 查询的关于函数 abs 的信息;
 lookfor 命令针对的是关键字，便于在 .m 文件中搜索相关信息。

 5.在MATLAB环境下，建立了一个变量fac，同时又在当前目录下建立了一个M文件fac.m，如果需要运行fac.m文件，该如何处理？
 1)定义一个新的变量如，fac_variable, 将fac的值赋给fac_variable，即：
   fac_variable = fac;
 2)使用 clear fac 命令，将变量fac从工作空间中清除掉，即可直接运行fac.m文件。
 综合1）和2）得到如下代码：
 fac_variable = fac;  % 定义新变量名，并保存fac中的值
 clear fac;  		  % 清除变量fac
 fac;                 % 执行fac.m中的代码

 第二章：MATLAB矩阵及其运算
%%%%%%%%
实验指导
%%%%%%%%
一、实验目的
1.掌握MATLAB数据对象的特点以及数据的运算规则。
1）MATLAB的数据对象
	A.基本数据类型
	    I.数值型: 整型、浮点型、复型
	    II.字符串：
	    char(ASCII码), abs('s')=double('s')=115;strcat(),strcmp(),				strcmpi(),findstr(),strrep();
	B.复合数据类型
		I.结构（ struct ）：struct(),成员引用“.” a.x ,rmfield(A,'name');
		II.单元（ cell ）: cell(1,2), A = {1,'X',B},c = A{1};
	C.MATLAB没有专门的逻辑数据
	    数值 1 和非零数值表示“真”，0 表示“假”。
2）数据运算规则
	A.数据运算维度要匹配，如矩阵的乘法要求矩阵行和列要匹配；
	B.矩阵的逻辑运算针对的是矩阵中的每一个元素;
	C.矩阵的运算：+、-、*、\、/、.*、<、>、<=、>=、==、~=

2.掌握MATLAB中建立矩阵的方法以及矩阵处理的方法。
1）建立矩阵的方法
	A.直接输入法：元素与元素之间用逗号“,”隔开，行与行之间用分号“;”隔开；
	B.冒号表达式建立向量，如 e1:e2:e3, 其中e1与e3分别为起始和终止值，e2为步长；
	C.利用小矩阵，构建大矩阵，如A = [1,2],B = [A,A;A,A];
2）矩阵的处理方法（理解矩阵元素的存储逻辑：按列依次存储）
	A.矩阵的引用方式：
		A(i,j)、A(i,:)、A(:,j)、A(:)、A(1:i,:)、A(:,j:end)、A(a:b,c:d);
	B.利用空矩阵删除矩阵的元素;
	C.改变矩阵的形状：reshape(A,m,n) 元素个数保持不变;
	D.元素序号与下标相互转化：
		I.sub2ind(size(A),i,j), ind2sub(size(A),j);
		II.矩阵元素的查找：
			[i,j] = find(A); % 下标  
			index = find(A); % 序号
	E.通用的特殊矩阵：zeros(m),ones(m),eye(m),rand(m),randn(m)
	F.随机矩阵的拓展：
		rand(1)--> a+(b-a)*rand(1): [0,1] --> [a,b]
		randn(1)--> mu+Sqrt(variance)*randn(1): N(0,1)-->N(mu,variance)

3.掌握MATLAB分析的方法。
MATLAB分析主要针对矩阵进行。对矩阵主要有：
1）% 对角元素/矩阵，上\下三角矩阵
   diag(A)、diag(diag(A))、triu(A)、tril(A)
2）% 转置、共轭转置、旋转(逆时针旋转90度的k倍)、翻转
   A’、A.’ 、rot90(A,k)、fliplr(A)、flipud(A) % l: left, u: up
3）%逆、伪逆、行列式、秩、迹、范数、条件数、特征分解
	inv(),pinv(),det(),rank(),trace(),norm(a,2),norm(A,2),cond(),
	eig()

二、实验内容
1.略。
2.略。
3.略。
4.略。
5.已知：A = [-29,6,18;20,5,12;-8,8,5],求A的特征值及特征向量，并分析其数学意义。
[P,E,~] = eig(A); % P为特征向量构成的矩阵，E为特征值构成的对角矩阵
P = [0.7130    0.2803    0.2733
	-0.6084   -0.7867    0.8725
	 0.3487    0.5501    0.4050];
	 
E = [25.3169   0          0
      0        -10.5182   0
      0		   0          16.8351];
数学意义：
（1）矩阵特征值对应特征多项式的根；
A*Epsilon = lambda*Epsilon
(A-lambda*I)*Epsilon = 0   % 特征多项式
（2）多项式方程的根对应其伴随矩阵的特征值。
伴随矩阵： compan()

%%%%%%%%
思考练习
%%%%%%%%
一、填空题
1.略。
2.略。
3.略。
4.有3x3矩阵，求其第5个元素的下标命令是（[i,j] = ind2sub([3,3],5)），求其第三行、第三列元素的序号的命令是（index = sub2ind([3,3],3,3)）.
5.略。
6.将矩阵A对角线元素加30的命令是（ A+30*eye(size(A,1)) ）
7.设A为2x3矩阵，则用zeros(size(A))建立的矩阵是（2）行（3）列的（零）矩阵。
  即，zeros(size(A))产生与A同维大小的零矩阵。
8.略。
9.下列命令执行后，new_claim的值是（'This is a great example.'）
>> claim = 'This is a good example.'
>> new_claim = strrep(claim,'good','great')  % strrep: 替换字符串
10.略。

二、问答题
补充题：
0.命令X = []与 clear X 有何不同？clear 与 clear x又有何不同？
1）clear X 是将 X 从工作空间中删除，而 X = [] 是对X赋空矩阵。空矩阵存在于工作空间中，只是没有任何元素;
2）clear x：仅仅将x从工作空间中删除，clear 是删除整个工作空间。

1.在一个MATLAB命令中，6+7i和6+7*i有何区别？i和I有何区别？
在6+7i中，i是虚数单位；在6+7*i中，i可以看做是一个运算量（变量），这个变量的性质是 i*i == -1。i是MATLAB预先定义的变量，可直接使用，而I需要定义或赋值才可使用。

2. 设A和B是两个同大小的矩阵，试分析A*B,A.*B,A./B,B.\A,A/B,B/A的区别？如果A和B是两个标量数据，结论又该如何？
1）分析表达式的区别
y左除x：x\y <=> (x^(-1))*y;  
y右除x: y/x <=> y*(x^(-1)); 
.*, ./, .\是逐元素进行操作;
所以，A*B是矩阵相乘，要服从行列维度匹配原则；A.*B是A和B中对应元素相乘；
A./B是A中的元素逐个被B中的元素对应相除。B.\A的意义与A./B相同，因为B与A的位置互换，右除此时变成了左除。A/B = A*(B^-1), B/A = B*(A^(-1)),故两者意义不同。
2）若A和B是两个标量数据，则A*B=A.*B, A./B=B./A=A/B=B/A。

3.写出完成下列操作的命令。
1）删除矩阵A的第7号元素： A(7) = [];  % 空矩阵删除矩阵元素，A矩阵变成了向量
2）将向量t的0元素用机器零来代替：t(t==0) = eps; % 2.2204e-16
3）将含有12个元素的向量x转换成3x4矩阵：reshape(x,3,4)
4）求一个字符的ASCII：abs('s') 或 double('s')
5）产生和A同样大小的幺矩阵: ones(size(A))
6）从矩阵A提取主对角线元素，并以这些元素构成对角矩阵B: B = diag(diag(A))

4.要产生均值为3，方差为1的500个正态分布的随机序列，写出相应的表达式。
% 尽量用符号的形式，避免出错
m = 3;    % mean
v = 1;    % variance
N = 500;  % number
seq = mu+ sqrt(v)*randn(1,N); % sequence

5.求下列矩阵的主对角元素、上三角阵、下三角阵、逆矩阵、行列式的值、秩、范数、条件数、迹。
1）A = [
	     1    -1     2     3
	     5     1    -4     2
	     3     0     5     2
	    11    15     0     9   ]

    elem = diag(A)';          % 主对角元素 [1 1 5 9]
    upMatrix = triu(A);    % 上三角阵
         1    -1     2     3
	     0     1    -4     2
	     0     0     5     2
	     0     0     0     9
	lowerMatri = tril(A);  % 下三角阵
	invA = inv(A);         % 逆阵
	   -0.1758    0.1641    0.2016   -0.0227
	   -0.1055   -0.1016   -0.0391    0.0664
	   -0.0508   -0.0859    0.1516    0.0023
	    0.3906   -0.0312   -0.1813    0.0281
	detA = det(A); % 行列式的值 1.2800e+03
	rankA = rank(A); % A的秩为4
	l1_norm = norm(A,1);
	l2_norm = norm(A,2);   % 注意矩阵的2范数与向量的2范数定义不一样
	cond_A = cond(A);      % 矩阵的条件数
	trace_A = trace(A);    % 矩阵的迹

2） B = [0.43 43 2;-8.9,4,21];
	diag(B)' = [0.4300 4.0000];  
	inv(B);   % 错误：inv 作用的矩阵必须是方阵
	pinv(B) = [ 0.0022  -0.0175
			    0.0234  -0.0017
			    0.0035   0.0405 ]  % pinv() 可以是方阵也可不是
	det(),trace(),inv() % 要求矩阵必须是方阵
	
6.当A = [34,NaN,Inf,-Inf,-pi,eps,0]时，求下列函数的值：
all(A) == 0; % 当且仅当所有元素都为非0时为真
any(A) == 1; % 只要有一个元素非0时为真
isnan(A) == [0 1 0 0 0 0 0]; % 判断A中每一个元素是否为NaN,并返回0和1
isinf(A) == [0 0 1 1 0 0 0]; % 判断A中每一个元素是否为inf,并返回0和1
isfinite(A) == [1 0 0 0 1 1 1]; % 判断A中每一个元素是否为有限制,并返回0和1

7.在MATLAB中如何建立结构矩阵和单元矩阵？
1）结构矩阵：
    A.建立结构矩阵：通过 "." 成员运算符构建结构矩阵，如 a.name = 'xiao ming',a即为结构数据类型；构建空结构矩阵： a = struct(); 
    B.引用结构数据：
    			   name = a.name---> 'xiao ming';
    			   name2 = a.('name') = 'xiao ming';
2) 单元矩阵: 
	A.建立单元矩阵：c = cell(1,2)或 c = {'x',1;'xiao ming',[1 2 3]};
	B.引用单元数据：c{1},c{1,2};

8.略。

第三章：MATLAB程序流程控制
%%%%%%%%
实验指导
%%%%%%%%
一、实验目的
1.掌握利用if语句、switch语句实现选择结构的方法。
1）if语句                    2) switch语句
A. if condition              switch 表达式              
    	xx                      case 值1
   end                             xxxx
B. if condition                 case 值m
		xx                         yyyy
else                            otherwise           
    	yyy                        zzzz
end                           end
C. if condition
		xxx
	elseif
		yyy
	elseif
		zzz
	else
		mmm
	end
2.掌握利用for语句、while语句实现循环结构的方法。
1）for语句
A. 常见格式：循环变量为标量
for 循环变量 = 表达式1: 表达式2: 表达式3
	循环体语句
end
B.拓展格式：循环变量为列向量
for 循环变量 = 矩阵表达式
	循环体语句
end
2）while语句
while 条件
	循环体语句
end
3）break和continue针对循环的控制

3.熟悉利用向量运算来代替循环操作的方法，并理解MATLAB程序设计的特点。
4.掌握定义和调用MATLAB函数的方法。
1）定义MATLAB函数
 functioin out_name = fun_name(par_1,par_2,...,par_n)
 函数体
 end
2）调用MATLAB函数：函数名+参数

二、实验内容
1.从键盘输入一个3位整数，将它反向输出。如输入639，输出为936。
approach 1:
n = input('请输入一个三位数：');
a = fix(n/100);    % fix: 朝零方向四舍五入为最近的整数
b = fix((n-a*100)/10);
c = n-a*100-b*10;
d = c*100+b*10+a;

approach 2:
number = input('输入一个数：','s');  % 以字符串的形式输入
disp(number(end :-1:1))

2.输入一个百分制成绩，要求输出成绩等级A,B,C,D,E. 其中90~100分为A，80~89分为B，70~79分为C，60~69分为D，60分以下为E。
要求：
1）分别用if语句和switch语句实现。
A.基于 if 语句的实现
n = input('请输入成绩: ');
if n>=90&n<=100
    p='A';
elseif n>=80&n<=89
    p='B';
elseif n>=70&n<=79
    p='C';
elseif n>=60&n<=69
    p='D';
else
    p='E';
end
fprintf('成绩等级: %s. \n',p)

B.基于switch语句的实现
n = input('请输入成绩：');
switch n
case num2cell(90:100)  % num2cell将数组转化为单元数
    p = 'A';
case num2cell(80:89)
    p = 'B';
case num2cell(70:79)
    p = 'C';
case num2cell(60:69)
    p = 'D';
otherwise 
    p = 'E';
end
fprintf('成绩等级: %s. \n',p)
2）输入百分制后要判断该成绩的合理性，对不合理的成绩应输出错误信息。
if n<=0
  error('Wrong Score')
end

3.略。（过于简单）
4.略。（过于简单）
5.略。（过于简单）

6.建立5x6矩阵，要求输出矩阵第n行元素，当n值超过矩阵的行数时，自动输出矩阵最后一行元素，并给出出错信息。
A = rand(5,6);
n = input('请输入n的值:');
try
	disp(A(n,:));
catch
	disp(lasterr);
	disp(A(end,:));
end

7.已知 y = f(40)/(f(30)+f(20))
1）当f(n) = n+10*log(n*n+5)时，y的值是多少？
step1：定义函数
function value = f(n)
 value = n+10*log(n*n+5);
end
step2：调用函数计算
y = f(40)/(f(30)+f(20));
2）当f(n) = 1X2+2X3+...+nx(n+1)时，y的值是多少？
f(n)表达式可以写成矩阵的形式：
function value = f(n)
a = 1:n;
b = a+1;
value = a*b';      % 以向量或矩阵运算代替累计求和，从而提升计算效率
% 知识拓展：若问题要求计算累计乘，则可以基于对数将乘法变成加法，从而利用矩阵运算，快速进行计算。log(x1*x2*x3,...,x_n) = log(x1)+log(x2)+...+log(x_n)

8.先用函数的递归调用定义一个函数文件：1^m+2^m+...+n^m,然后调用该函数文件求
(1+2+...+100)+(1^2+2^2+...+50^2)+(1^-1+2^-1+...+10^-1) 
A: 定义递归函数，调用该函数进行计算
function value = power_add(n,m)
if n == 1
	value = 1^m;
else
	value = power_add(n-1,m)+n^m;
end  
end

% 调用power_add函数 
result = power_add(100,1)+power_add(50,2)+power_add(10,-1);

B. 基于矩阵运算，定义函数
function value = power_add(n,m)
x = 1:n;
value = (x.^m)*ones(n,1);   % 更加简洁高效，其中ones(n,1)可以替换成权重

%%%%%%%%
思考练习
%%%%%%%%
一、填空题
1. 将有关MATLAB命令编成程序存储在一个扩展名为.m的文件中，该文件称为        。（M文件）。 % M文件既可能是脚本文件（可直接在命令行窗口执行），也可能是函数文件（需要调用才能执行。）

2.MATLAB中用于控制不确定重复次数的循环语句为（ while 语句），若在循环执行过程中需要终止该循环时采用的语句为（ break 语句）。

3.函数文件由（ function ）语句引导。在函数定义时，函数的输入输出参数称为（形式）参数，简称（形参）。在调用函数时，输入输出参数称为（实际）参数，简称（实参）。% 形参不一定要与实参一致，但两者需要保持位置和数量一致。

4. 应用程序的错误有两类，一类是（语法）错误，另一类是运行时的错误，即（逻辑）错误。MATLAB程序调试方法有两种，一是利用（调试函数）进行程序调试，二是利用   （调试工具）进行程序调试。

5.有以下语句：
a = eye(5);
for n = a(2:end,:), 则 for 循环的循环次数是（5）。% n每次被赋值为一列

6.有以下程序段：
x = reshape(1:12,3,4);
m = 0;
n = 0;
for k = 1:4
	if x(:,k)<=6    % 当且仅当x(:,k)中的所有元素都小于或等于6时，条件才成立
		m = m+1;
		else
		n = n+1;
	end
end
则m和n的值分别是(2,2)。

7.执行下列语句后，变量A的值是（25）。
f = @(x,y)log(exp(x+y));   % 等价于 f = @(x,y)x+y
A = f(22,3);

二、问答题
1.略。
2.略。
3.编写程序，产生20个两位随机整数，输出其中小于平均值的偶数。
%% 产生20个两位数的随机整数
x = fix(10+rand(20,1)*89);
% num = 10:99;    % 共90个数
% index = randperm(90)；  % 对90个数的下标进行随机排列
% x = num(index(1:20))   % 取20个随机整数

%% 求平均值
a = sum(x)/20;
% a = mean(x);

%% 基于for循环输出小于平均值的偶数
for i = 1:20
	if x(i)<a
		if rem(x(i),2)==0  % rem: 求余函数
			disp(x(i))
		end
	end
end

%% 基于逻辑关系选择符合要求的数（巧用逻辑关系运算，提高查询效率）
y = x(x<a);
z = y(rem(y,2)==0); % ~rem(y,2)表示余数为

4.当n分别取100,1000,10000时，求下列式子的值。
1）1 - 1/3 + 1/5 - 1/7 + ...
A. 基于循环结构进行计算
s = 0;
flag = 1;
for i = 1:n
	term = flag/(2*i-1);  % 通项
	s = s+term;
	flag = -flag;  % 控制每一项的符号
end

B.基于矩阵/向量进行计算
index = 2:2:n;
flag = ones(1,n);
flag(index) = -1;    % flag = [1,-1,1,.....]
term = 1:2*n;        % 定义term为所有偶数和奇数的集合
term(2:2:2*n) = [];  % 利用空矩阵将偶数部分删除
den_term = 1./term;  % 对所有项求倒数
s = flag*den_term';  % 利用向量的乘法一次性求和

5.略。
6.略。

第四章：MATLAB绘图
%%%%%%%%
实验指导
%%%%%%%%
一、实验目的
1.掌握绘制二维图形及三维图形的方法。
1）绘图步骤：
A.产生系列的数据点(x1,y1),...,(x_n,y_n);
	I.冒号表达式设置x的值：x = e1:e2:e3
	II.linspace(e1,e2,N): 在区间[e1,e2]自动选定和N个数据点
B.调用相关绘图函数进行绘图;
C.对图形进行修饰处理，如加图的标题、坐标轴标注、改变颜色等。
2）二维图形
plot(x,y)   % x,y为等长度的向量
plot(y)     % 若y为实向量，则以y的下标为横坐标，y的值为纵坐标进行绘图
plot(x,y,选项)
3）三维图形
meshgrid(): 产生三维数据
mesh(), surf(): 绘制三维曲面

2.掌握图形控制及修饰处理的方法。
1）图形标注：title(), xlabel(),ylabel(),text(),legend()
2）坐标控制: axis equal, axis square, axis auto, axis off, axis on 
3）视点处理：view(az,,el) 方位角、仰角
3）其他处理：grid on/off, box on/off, subplot(),hold on/off

3.了解图像处理及动画制作的基本方法。
略。

二、实验内容
1.绘制下列曲线。
1） y = x - x^3/(3!)

	% 绘图程序
	x = linspace(0,10,100); % 产生系列的点
	y=x-x.^3/6;   		    % 计算函数值
	plot(x,y)               % 调用绘图函数

2）x^2+2*y^2 = 64

	% 绘图程序
	t = 0:0.01:2*pi;
	x = 8.*cos(t);
	y = 4*sqrt(2).*sin(t);
	plot(x,y)

2. 设 y = 1/(1+exp(-t)), -pi<=t<=Pi,在同一窗口采用子图形式绘制条形图、阶梯图、杆图和对数坐标图等不同图形，并对不同图加标注说明。

% 绘图程序
t = -pi:pi/10:pi;               % 取点
y  =1./(1+exp(-t));             % 求值
subplot(2,2,1);                 % 子图
bar(t,y,'b');   
title('bar(t,y,''b'')');
subplot(2,2,2);
stairs(t,y,'k');
title('stairs (t,y,''k'')');
subplot(2,2,3);
stem(t,y,'m');
title('stem (t,y,''m'')');
subplot(2,2,4);
loglog(t,y,'g');
title('loglog(t,y,''g'')');

3.绘制下列极坐标图。
1） rho = 5*cos(theta)+4

	% 绘图程序
	t = 0:pi/100:2*pi;
	y = 5*cos(t)+4;
	polar(t,y,'-*')
2）gamma = 5*sin(phi)^2/cos(phi), -pi/3<=phi<=pi/3

	% 绘图程序
	t = -pi/3:pi/100:pi/3;   % 取步长为pi/100
	r = 5*sin(t).^2./cos(t); 
	polar(t,r,'-*')

4.绘制下列三维图形
1） x = exp(-t/20)*cos(t)
    y = exp(-t/20)*sin(t)
    z = t
    0<=t<=2*Pi

    % 绘图程序
    t=0:pi/100:2*pi;
	x=exp(-t/20).*cos(t);
	y=exp(-t/20).*sin(t);
	z=t;
	plot3(x,y,z)
	grid on
2）z = 5, |x|<=5, |y|<=5。要求应用插值着色处理。
	% 绘图程序
	[x,y] = meshgrid(-5:5);
	z=zeros(11)+5;
	mesh(x,y,z);
	shading interp;

5. 播放一个直径不断变化的球体。
	% 绘图程序
	[x,y,z] = sphere(20);
	surf(x,y,z);
	axis off;
	shading interp;
	m = moviein(20);
	for i = 1:20
	    axis([-i,i,-i,i,-i,i])
	    m(:,i) = getframe;
	end
	movie(m,4); 

%%%%%%%%
思考练习
%%%%%%%% 
一、填空题   
1.执行以下命令
  >> x = 0: pi/20:pi
  >> y = sin(x)
以x为横坐标，y为纵坐标的曲线图绘制命令为（ plot(x,y)），给该图形加上“正弦波”标题的命令为（ title('正弦波')），将该图形的横坐标标注为“时间”，纵坐标标注为“幅度”的命令分别为（ xlabel('时间') ）和（ylabel('幅度')）。

2.如果x,y均为4x3矩阵，则执行 plot(x,y) 后在图形窗口绘制（3）条曲线。

3.在同一图形窗口中绘制y1和y2两条曲线，并对图形坐标进行控制，请补充程序。
x = -3:0.1:3;
y1 = 2*x+5;
y2 = x.^2-3*x;
plot(x,y1);       % 绘制曲线y1
hold on           % 补充的代码片段1
plot(x,y2)
m1 = max([y1,y2]);
m2 = min([y1,y2]);
axis([-3,3,-5,20])  % 补充的代码片段2：约束图形坐标区间

4.下列命令执行后得到的图形是（单位圆）
>> x = @(t)sin(t)
>> y = @(t)cos(t)
>> ezplot(x,y)

5.下列程序的运行结果是（五个同心圆）
x = 0:pi/100:2*pi;
for n = 1:2:10
	plot(n*sin(x),n*cos(x))
	hold on 
end

二、问答题
1.在同一坐标中绘制多条二维曲线，有哪些方法？
一般有四种方法：
1）令多条曲线共用横坐标，将多条曲线的函数值构造成矩阵形式，用plot(x,Y)绘图，
   其中 x为共有的横坐标向量，Y = [y1;y2;y3...],即可以在同一窗口绘制多条曲线；
2）在1）的基础上，若多条曲线的横坐标不相同，则令X = [x1,x2,x3,...],Y = [y1,y2,...]，基于plot(X,Y)也可以实现在同一坐标中绘制多条曲线；
3）基于向量对x1,y1,x2,y2,...，用plot(x1,y1,x2,y2,....)也可以绘制多条曲线；
4）基于hold on 命令，在绘制上一幅图形之后，使得图形窗口不被刷新，从而绘制多条曲线。

2.绘制下列曲线。
1） y = exp(-x^2/2)/(2*pi) 

	% 绘图程序
	x = -5:0.01:5;
	y = (1/(2*pi)).*exp(-(x.^2)/2);
	plot(x,y);

2）x = t*sin(t)
   y = t*cos(t)
   
   % 绘图程序
   t = -2*pi:pi/100:2*pi;
   x = t.*sin(t);
   y = t.*cos(t);
   plot(x,y);
   grid on;

3.在同一个坐标轴中绘制下列两条曲线并标注两曲线的交叉点。
1）y = 2*x-0.5
2）x = sin(3*t)*cos(t)
   y = sin(3*t)*sin(t)
   0<=t<=Pi

   % 描点绘图
    t = 0:pi/1000:pi;
	x = sin(3.*t).*cos(t);   
	y1 = sin(3.*t).*sin(t);
	y2 = 2.*x-0.5;
	
	% 同一个坐标轴中画两条曲线
	plot(x,y1,'k',x,y2);     
	hold on;

	% 寻找两个曲线的交点
	k = find(abs(y1-y2)<1e-2);
	x1 = x(k);
	y3 = 2.*x1-0.5;
	plot(x1,y3,'rp');

4.分别用 plot 和 fplot 函数绘制函数y = sin(1/x)的曲线，分析两曲线的差别。
% 绘图程序
x = -2:0.01:2;
y = sin(1./x);   % 不能真实反映函数的变化
subplot(2,1,1);
plot(x,y);
subplot(2,1,2);
fplot('sin(1./x)',[-2,2],1e-4);   % 自适应采样，能真实反映函数的变化

plot 与 fplot 的区别： plot绘图一般是先取足够稠密的自变量向量, 计算函数值向量y，进而绘图。plot 在取数据点时，一般是等间距的，这对绘制高频函数不够精确。而 fplot 函数正好可以弥补这一曲线，能够自适应地对自变量向量进行采样。

5.绘制下列极坐标图。
1） rho = 12/sqrt(theta)
% 绘图程序
i = -4*pi:pi/50:10;
j = 12./sqrt(i);
polar(i,j);
title('{\rho}=12/sqrt(\theta)')

2）gamma = 3*asin(phi)*cos(phi)/(sin(phi)^3+cos(phi)^3)， -pi/6<=phi<=pi/6
% 绘图程序
a = -pi/6:pi/50:pi/6;
b = 3.*asin(a).*cos(a)./((sin(a)).^3+(cos(a)).^3);
polar(a,b);

6.绘制曲面图形。
1） x = 3*u*sin(v)
    y = 2*u*cos(v)
    z = 4*u^2

    % 绘图程序
    [u,v] = meshgrid(-4:0.1:4);
	x = 3.*u.*sin(v);
	y = 2.*u.*cos(v);
	z = 4.*u.^2;
	subplot(2,1,1);
	mesh(x,y,z);
	subplot(2,1,2);
	surf(x,y,z);

2）f(x,y) = -5/(1+x^2+y^2), |x|<=3, |y|<=3

	% 绘图程序
	[x,y] = meshgrid(-3:0.1:3);
	z = -5./(1+x.^2+y.^2);
	subplot(1,2,1);
	mesh(x,y,z);
	subplot(1,2,2);
	surf(x,y,z);


第五章：MATLAB数据分析与多项式计算
%%%%%%%%
实验指导
%%%%%%%%
一、实验目的
1.掌握数据统计和分析的方法。
统计和分析是认识数据的基本方法。
1）MATLAB提供了最大和最小值（max,min）、和与积（sum, prod）、平均值和中值（mean,median）、累加和累乘（cumsum,cumprod）、标准差和相关系数（std,corrcoef）、排序（sort）等函数。
2）理解MATLAB按列存储元素的规则，理解上述方法的正确使用。

2.掌握数据插值和曲线拟合的方法及其应用。
1）数据插值：根据已知的数据点，插入（预测）其他点对应的数值。
A.一维数据插值(interp1)：线性插值'linear'（默认）,最近点插值'nearest',分段3次埃尔米特插值'pchip',3次样条插值'spline'。相对于线性插值和最近点插值，分段埃尔米特插值和样条插值对各数据点的过渡更光滑，因为它们使用了三次多项式和一、二阶导数。
B.二维数据插值(interp2): 所涉及的方法有线性插值'linear'（默认）,最近点插值'nearest'和次样条插值'spline'，不支持埃尔米特插值'pchip'。
2）曲线拟合：用较简单的函数逼近一个区间或一个区域上有限个采样点所刻画的函数。
A.曲线拟合的最小二乘法原理：最小化拟合多项式在各数据点处的偏差，即最小化二次误差。
B.最小二乘拟合多项式相关函数：
	polyfit: 求多项式的系数向量；
	polyval: 基于拟合的多项式计算给出点处的近似函数值；
C.关键信息：多项式的系数向量，别忘了缺失的幂次项系数在系数向量中以0显示。

3.掌握多项式的常用运算。
针对多项式系数向量，有下列函数(P1等为多项式的系数向量)：
1）乘法：conv(P1,P2)
2）除法：deconv(P1,P2)
3）求导：polyder(P),polyder(P,Q)
4）求根：roots(P)   % P = 0 的根

二、实验内容
1.利用MATLAB提供的randn函数生产符合正态分布的10X5随机矩阵A，进行如下操作：
1）A各列元素的均值和标准差;
2）A的最大元素和最小元素;
3）求A每行元素的和以及全部元素之和;
4）分别对A的每列元素按升序、每行元素按降序排序。
为了便于求解，对A进行分析的时候可以用命令“A_hat = A(:)” 将A中所有元素展成一列向量。 

% source code 
A = randn(10,5);    % 生产标准正态分布的随机矩阵
 1）%各列元素的均值 
    mu_column = mean(A);    
    %各列元素的标准差
    std_column = std(A);
 2）%最大元素和最小元素
 	max_val = max(A(:));
 	min_val = min(A(:));
 3）%求A每行元素的和以及全部元素之和;
 	sum_row = sum(A,2);  %sum默认对每列求和，对每行求和，则用sum(A,2)
 	sym_all = sum(A(:)); %全部元素之和
 4）%对A的每列元素按升序排列
 	sort_column = sort(A,'ascend');
 	%对A的每行元素按升序排列
 	sort_row = sort(A,2,'descend');

2.按要求对制定函数进行插值和拟合。
1）按表5-4用3次样条方法插值计算0~90度内整数点的正弦值和0~75度内整数点的正切值，然后用5次多项式拟合方法计算相同的函数值，并将两种计算结果进行比较。
2）按表5-5用3次多项式方法插值计算1~100之间整数的平方根。

1）%source code
	a = 0:15:90;    % 已知的数据点
	b = a./180.*pi; % 将角度转化成弧度
	s = sin(b);     % 计算已知数据点对于的函数值
	c = 0:15:75;
	d = c./180.*pi;
	t = tan(d);
	
	e = input('请输入想计算的值：');
	S = sin(e/180*pi);
	T = tan(e/180*pi);
	S1 = interp1(a,s,e,'spline');  % 基于样条插值计算近似的函数值
	T1 = interp1(c,t,e,'spline');

	P1 = polyfit(a,s,5);   % 5次多项式拟合，得到对于的多项式系数向量
	P2 = polyfit(c,t,5);
	S2 = polyval(P1,e);    % 多项式求值
	T2 = polyval(P2,e);
2）略。

3.有两个多项式P(x) = 2*x^4-3*x^3+5*x+13, Q(x)=x^2+5*x+8, 试求P(x),P(X)*Q(x)P(x)/Q(x)的导数。

% source code
P = [2,-3,0,5,13];  % 提取多项式的系数向量
Q = [1,5,8];
der_P = polyder(P);
der_Q = polyder(P,Q);
[a,b]=polyder(P,Q);

4.有3个多项式P1(x) = x^4+2*x^3+4*x^2+5, P2(x) = x+2; P3(x) = x^2+2*x+3,进行下列操作：
1）求P(x) = P1(x)+P2(x)P3(x)；
2）求P(x)的根；
3）当x取矩阵A的每一元素时，求P(x)的值；
4）当以矩阵A为自变量时，求P(x)的值。

% source code
1）求P(x) = P1(x)+P2(x)P3(x)
p1 = [1,2,4,0,5];
p2 = [0,1,2];      
% warning: 之所以在p2的第一个元素前面补0，是考虑到P2,P3相乘后要构造成与P1同幂次的多项式，只有这样p2与p3相乘的结果才能与p1直接相加。
p3 = [1,2,3];
P = p1+conv(p2,p3)； % P = [1 3 8 7 11]
所以P(x) = x^4+3*x^3+8*x^2+7*x+11      % 这一步才是最终结果

2）求P(x)的根；
x = roots(P); 
3）当x取矩阵A的每一元素时，求P(x)的值
P_x = polyval(P,A(:));
4）当以矩阵A为自变量时，求P(x)的值。
P_A = polyval(P,A);

%%%%%%%%
思考练习
%%%%%%%%
一、填空题（略）
二、问答题
1~3.略。
4.利用MATLAB提供的rand函数生成30000个符合均匀分布的随机数，然后检验随机数的性质。
1）~2）略。
3）求大于0.5的随机数个数占总数的百分比。
% source code
A = rand(1,30000);
percent = sum(A(A>0.5))/30000;    % 37.61%

5.略。

6.已知lgx在[1,101]区间11个整数采样点的函数值如表5-6所示。试求lgx的5次拟合多项式p(x)，并绘制出lgx和p(x)在[1,10]区间的函数曲线。
% source code 
x = [1:10:101];
y = [0,1.0414,1.3222,1.4914,1.6128,1.7076,1.7853,1.8513,1.9085,1.9590,2.0043];
p = polyfit(x,y,5);  % 基于polyfit求拟合多项式的系数
a = 1:5:101;
y1 = polyval(p,a);
plot(x,y,':o',a,y1,'-*');

第六章：MATLAB解方程与最优化问题求解
%%%%%%%%
实验指导
%%%%%%%%
一、实验目的
1.掌握线性方程组的数值求解方法。
1）直接求解方法
	A.左除运算：区分矩阵的左除和右除
	B.基于矩阵分解的求解方法：LU分解、QR分解、Cholesky分解，Schur分解等;
2）迭代求解方法：
	A.Jacobi迭代法
	B.Gauss-Serdel迭代法

2.掌握常微分方程的数值求解方法。
略。

3.掌握非线性方程以及最优化问题的求解方法。
1）非线性方程求解
	A.单变量非线性方程求解：x = fzero(@fname,x0);
	B.非线性方程组的求解：x = fsolve(@fname,x0);
2）最优化问题求解
	A.无约束最有优化问题求解：
		I.一元函数优化问题：fminbnd(@fname,x1,x2,options);
		II.基于单纯形法的多元函数优化问题：fminsearch(@fname,x0,options);
		III.基于拟牛顿法的多元函数优化问题：fminunc(@fname,x0,options);
		Remark: 求解的关键在于正确地表达函数，以及提供合适的初始值。
	B.有约束最优化问题求解：
		fmincon(); 正确表达约束条件，调用fmincon函数求解。
	C.线性规划问题求解：linprog函数。
	
二、实验内容
1.下面是一个线性病态方程组：
				[1/2  1/3  1/4
				1/3   1/4  1/5  * [x1,x2,x3]' = [0.95 0.67 0.52]'
				1/4   1/5  1/6]
1）求方程的解;
2）将方程右边向量元素b3改为0.53，再求解，并比较b3变化和解的相对变化；
3）计算系数矩阵A的条件数，并分析结论。

% source code
A = [1/2,1/3,1/4
	 1/3,1/4,1/5
	 1/4,1/5,1/6];
b = [0.95;0.67;0.52];

1）% 求方程的解
直接法： x = A\b;   % x = [1.2,0.6,0.6]';
2）% 修改b中的元素
b(3) = 0.53;
x2 = A\b;  % x2 = [3,-6.6,6.6];
b3由0.52变成0.53，对求解结果产生了较大影响，说明A是一个病态矩阵，
3）% 计算系数矩阵A的条件数。
con_num = cond(A);    % con_num =  1.3533e03;
结论：线性方程组系数矩阵的条件数越小，数值的微小变化不会对求解结果产生明显影响，反之亦然 。

2.求下列方程的解。
1） x^41+x^3+1 = 0, x0 = 1
基于单变量非线性方程求解：

% source code
% 设置初始条件
x0 = -1;
% 定义匿名函数
fun = @(x)x^41+x^3+1;
% 基于fzero函数求解
x = fzero(fun,x0);   % x =  -0.9525

2）x - sin(x)/x = 0, x0 = 0.5
x0 = 0.5;
fun2 = @(x)x - sin(x)/x;
x = fzero(fun2,x0);   % x = 0.8767

3） sin(x)+y^2+lnz-7 = 0
    3*x+2*y-z^3+1 = 0
    x+y+z-5 = 0, 初始值x0=1,y0=1,z0=1

% source code
% step 1
% 定义函数文件，将非线性方程组的非0项表达成为函数值矩阵
function v = my_fun(p)
% 令 x = p(1); y = p(2); z = p(3); 构造函数值矩阵如下
v = zeros(3,1);  % 预分配空间
x = p(1); 
y = p(2); 
z = p(3);

% 将函数值装入向量v
v(1) = sin(x)+y^2+log(z)-7;
v(2) = 3*x+2*y-z^3+1;
v(3) = x+y+z-5;
end

% step 2
设定初始值
p0 = [1;1;1];

% 调用函数fsolve对非线性方程组进行求解
options = optimset('Display','off'); % 不显示求解相关信息
result = fsolve(@my_fun,p0,options); % result = [0.6331,2.3934,1.9735]
% Remark: 若my_fun是通过函数文件定义的，前面必须加‘@’；若my_fun是通过匿名函数定义的，则直接使用该匿名函数名称。

3.略。

4.求函数在指定区间的最大值
f(x) = (1+x^2)/(1+x^4), x belogs to [0,2]

该问题属于一元函数优化问题，可用fminbnd(@fname,x1,x2,options)求解
% source code 
% 定义匿名函数
my_fun2 = @(x)-(1+x^2)/(1+x^4)
x = fminbnd(my_fun2,0,2);
f_max = -my_fun2(x);   % f_max = 1.2071

5.设有400万资金，要求4年内使用完，若一年内使用资金x万元，则可得到效益sqrt(x)万元（效益不能再使用），当年不用的资金可存入银行，年利率为10%。试制定出资金的使用计划，以使4年效益之和为最大。

% 题意分析
该题的关键在于写出收益函数：
设1~4年使用的资金分别为x_1,x_2,x_3,x_4
第一年收益：sqrt(x_1)+(400-x_1)/10
第二年收益：sqrt(x_2)+(400-x_1-x_2)/10
第三年收益：sqrt(x_3)+(400-x_1-x_2-x_3)/10
第四年收益：sqrt(x_4)
总收益：
f(x_1,x_2,x_3,x_4) = sqrt(x_1)+sqrt(x_2)+sqrt(x_3)+sqrt(x_4)+(400-x_1)/10+(400-x_1-x_2)/10+x_4/10
令 x = [x_1;x_2;x_3;x_4];
则f可简写为：
f(x) = sum(sqrt(x))+(1200-3*x(1)-2*x(2)-x(3))/10
     = sum(sqrt(x))+120-[3,2,1,0]*x/10;
% 忽略常数，不影响函数优化，f(x)进一步简化为
f(x) = sum(sqrt(x))-[3,2,1,0]*x/10;

% 约束条件
x_1>=0
x_2>=0
x_3>=0
x_4>=0
x_1 + x_2 + x_3 + x_4 == 400  % ones(1,4)*x==400

% 基于有约束的优化问题进行求解：fmincon();
% step 1: 构建目标函数文件或定义匿名函数
% 将最大化问题转换为最小化问题
my_fun3 = @(x)-sum(sqrt(x))+[3,2,1,0]*x/10; 

% step 2: 约束条件的标准化表达
A = [];
b = [];    % 无不等式约束
Aeq = ones(1,4);
beq = 400; % 等式约束
Lbnd = 0;  % x的下界
Ubnd = 400; % x的最大值不超过400
NonF = [];  % 不存在非线性函数

% step 3: 将上述条件带入求解函数fmincon()
%设定初始值
 x0 = 100*ones(4,1);
%设定求解信息
options = optimset('Display','off');
opt_x = fmincon(my_fun3,x0,A,b,Aeq,beq,Lbnd,Ubnd,NonF,options)；

% opt_x =  [2.3559,4.9053,15.8089,376.9299];
即资金的使用计划为：第一年2.3559万，第二年4.9053，第三年45.8089万，第四年376.9299万。最大收益为143.8717万元。

%%%%%%%%
思考练习
%%%%%%%%
1.线性方程组的求解方法可以分成两类，一类是（直接解法），另一类是（迭代解法）。前者是在没有舍入误差的情况下，通过有限步的初等运算求得方程组的解；后者是先给定一个解的（初值），然后按照一定的算法不断用变量的旧值递推出新的值。

2.MATLAB用（fzero）函数求单变量非线性方程的根。对于非线性方程组，则用（fsolve）函数求其数值解。

3.已知函数文件fx.m:
function f = fx(x)
f = 2*x.^2+5*x-1;
则 f(x)在x0 = -2附近的根的命令是（opt_x = fzero(@fx,x0)）。

4.已知：fx = @(x)2*x.^2+5*x-1,则x0 = -2附近的根的命令是（opt_x = fzero(fx,x0)）。
注意对比上述3和4题的差别，用函数文件的时候是(@函数名)，用匿名函数的时候是(匿名函数名，没有@符号)

5~6.略。

二、问答题
1.略。

2.求下列方程的解。
1）3*x+sin(x)-exp(x)=0
reuslt = fzero(@(x)3*x+sin(x)-exp(x),1.5);
2）x-1/x+5=0在x0=1附近的解。
reuslt = fzero(@(x)x-1/x+5,1);
3）x^2+y^2=9
   x+y=1
   x0 = 3
   y0 = 0

  % source code 
  % 定义目标函数
  function z = my_qe(p)
  z = zeros(2,1);
  x = p(1);
  y = p(2);
  z(1) = x^2+y^2-9;
  z(2) = x+y-1;

  % 设定初始值
  p0 = [3;0];

  % 调用函数fsolve对非线性方程组进行求解
  options = optimset('Display','off'); % 不显示求解相关信息
  result = fsolve(@my_qe,p0,options);

3. 略。

4.求函数在指定区间的最大值
f(x) = sin(x)+cos(x)^2, x belongs to (0,pi)
该问题属于一元函数优化问题，可用fminbnd(@fname,x1,x2,options)求解
% source code 
% 定义匿名函数
my_fun = @(x)-(sin(x)+cos(x)^2);  % 将最大化问题转化最小问题（看清题目）
x = fminbnd(my_fun,0,pi);  % x = 2.618
f_max = -my_fun(x);        % f_max = 1.25

5. 对边长为3m的正方形铁板，在4个角剪去相等的正方形以制成方形无盖水槽，问如何剪才能使得水槽的容积最大？
假定剪去的正方形边长为x,在留下的铁板的维度为：3-2*x, 3-2*x, x,则水槽的容积则表示为： v(x) = x*(3-2*x)^2。 将最大化容积问题抽象为数学问题如下：
min - x*(3-2*x)^2
s.t. 0<=x<=1.5
求解如下：
v = @(x)-x*(3-2*x)^2;
options = optimset('Display','off');
x = fminbnd(v,0,1.5,options);  % x = 0.5
v_max = -v(x);  			   % v_max = 13.089

第七章：MATLAB数值积分与数值微分
%%%%%%%%
实验指导
%%%%%%%%
一、实验目的
1.掌握积分的数值计算方法。
1）自适应积分法（全局自适应：一、二、三重积分等）
I = integral(@fnam,x_min,x_max);     % 一元函数积分
I = integral2(@fnam,x_min,x_max);    % 二重积分
I = integral3(@fnam,x_min,x_max);    % 三重积分
2）变步长辛普生法
I = quad(@fname,x_min,x_max,tol);
I = quadl(@fname,x_min,x_max,tol)
Remark: 构建被积函数时，要使用点运算符“.”；
3）高斯-克朗罗德法
I = quadgk(@fname,x_min,x_max);
4）梯形积分方法: I = trap(x,y);  % x,y为向量对，表示数据点
5）其他的多重积分计算方法
	A.二重积分：I = dblquad(@fname,x_min,x_max,y_min,y_max,tol)
	B.三重积分：
	I = triplequad(@fname,x_min,x_max,y_min,y_max,z_min,z_max,tol) 
	
2.掌握微分的数值计算方法。
1）polyder 和 polyval：
基于多项式拟合，构造对象函数的近似函数; 对近似函数，基于多项式求导函数polyder和polyval计算相应的微分；
2）diff:
基于差商，计算相应的微分；差商 = 差分之比；相关函数：向前差分diff(x),计算向量x的前向差分。

3.了解离散傅里叶变化算法及实现方法。
略。

二、实验内容
1.求定积分。(注意：不要忘记了'.'运算符)
1）I = integral(@(x)sin(x)./x,0,2);  % 1.6054
2）略。

2.求二重积分。
1）I1 = integral2(@(x,y)exp(-(x.^2+y.^2)),0,1,0,1);    % I1 = 0.5577
2）I2 = dblquad(@(x,y)abs(cos(x+y)),0,pi,0,pi,1e-10); %  I2 = 6.2832

3.分别用矩形、梯形公式计算表7-1中数据给出的定积分。
k       = 1        2       3       4       5        6       7 
x_k     = 0.3      0.5     0.7     0.9     1.1      1.3     1.5
f(x_k)  = 0.3895   0.6598  0.9147  1.1611  1.3971   1.6212  1.8325

% 矩形积分方法
x_k = [0.3, 0.5, 0.7, 0.9, 1.1, 1.3, 1.5];
f_x = [0.3895, 0.6598, 0.9147, 1.1611, 1.3971, 1.6212, 1.8325];
height = diff(x_k);    % 基于向前差分计算每个矩形的高度
weight = f_x(1:end-1); % 函数值为矩形的宽度
I_rectangle = weight*height';  % I_rectangle = 1.2287
I_trap = trapz(x_k,f_x);       % I_trap = 1.3730

4.设X由[0,2*pi]区间均匀分布的10个点组成，求向量sin(X)的1~3阶差分。
X = linspace(0,2*pi,10);
res = cell(1,3);
for i = 1:3
	res{i} = diff(sin(X),i);   
end

5.设 f(x) = sin(x)/(x+cos(2*x)),用3种不同的方法求函数f(x)的数值导数，并在同一个坐标系中作出f'(x)的图像。
% 设定数据点向量，构造系列函数值
deta = 0.01;
x = 0:deta:pi;

% 目标函数
f_x = @(x)sin(x)./(x+cos(2.*x));
y = f_x(x);   % 函数值向量

% 解析求导
g_x = @(x)(cos(x).*(x+cos(2*x))-sin(x).*(1-2*sin(2*x)))./(x+cos(2*x)).^2;
dg_x = g_x(x);

% 多项式拟合求导
p_x = polyfit(x,y,10); % 多项式拟合
dp = polyder(p_x);    % 多项式求导
dp_x = polyval(dp,x); % 多项式求值

% 基于差商求导
df_x = diff(f_x([x,pi+0.01]) )/deta;

% plots
plot(dg_x)
hold on
plot(dp_x)
plot(df_x)

6.略。

%%%%%%%%
思考练习
%%%%%%%%
一、填空题
1.在MATLAB中，没有直接提供求（数值导数）的函数，只有计算（向前差分）的函数diff。
2.MATLAB提供了基于全局自适应积分算法的（integral）函数来求定积分，该函数的积分限（可以）为无穷大。
3.基于变步长辛普生，MATLAB给出了（quad）函数和（quadl）函数来求定积分。
4.MATLAB提供的（integral2）、（quad2）、（dblquad）函数用于求二重积分的数值解，（integral3）、（triplequad）函数用于求三重积分。
5.略 。

二、问答题
1.略。
2.略。
3.求定积分。
1）I = integral(@(x)log(1+x)./(1+x.^2),0,1);  % 0.2722
2）I = integral(@(t)sqrt(cos(t.*t)+4*sin(2*t).^2+1),0,2*pi); % 10.4285
4.求三重定积分。% 2.5357
I = triplequad(@(x,y,z)4*x.*z.*exp(-z.^2.*y-x.^2),0,1,0,pi,0,pi,1e-10); 
5.略。

第八章：MATLAB符号运算
%%%%%%%%
实验指导
%%%%%%%%
一、实验目的
1.掌握符号对象的定义方法以及符号表达式的运算法则。
1）符号对象定义
	A.符号常量：sym(1), sym(pi)  % 符号常量只能通过函数sym定义
	B.符号变量：sym('a'), syms a; 
	C.多个符号变量定义：syms a b c;
2）符号变量与非符号变量区别
	A.非符号变量参与运算前必须赋值；符号变量参与运算前无须赋值;
	B.符号变量运算结果是符号表达式；非符号变量运算结果依赖于变量数据类型。
3）符号表达式的运算法则
	A.四则运算：非最简形式；
	B.提取符号表达式分子和分母：numden()
	C.因式分解与展开：factor(),expand(),collect(),
	D.符号表达式系数提取：coeffs();  % 缺失的系数不补0
	E.符号表达式化简：simplify()
	F.符号表达式-->数值表达式：eval()
	G.符号多项式-->提取多项式系数向量：sym2poly(s)  % 缺失的幂次项自动补0
	H.多项式系数向量-->符号多项式：poly2sym(p,x)    % 产生以符号变量为x的符														  号表达式
2.掌握微积分的符号计算方法。
1）符号极限：limit()
2）符号导数：diff()
3）符号积分: int()     % 注意与数值积分区分：integral

3.掌握级数求和的方法以及将函数展开为泰勒级数的方法。
略。

4.掌握代数方程和微分方程符号求解的方法。
1）代数方程： solve()
2）符号常微分方程：略。

二、实验内容
1.分解因式
1）x^4-y^4
syms x y;  % 定义符号变量
s = factor(x^4-y^4)
2）a = sym(5135);
   s = factor(a);
   
2.求函数的极限
1）syms x; res = limit((x-2)/(x^2-4),x,2);
2）sym('x');
   f = (sqrt(pi)-sqrt(acos(x)))/sqrt(x+1); 
   res =  limit(f,x,-1,'right');
   
3~6.略。

7.求非线性方程的符号解。
1）syms x a;
   s = x^3+a*x+1
   res = solve(s,x);
2）~3）略。
8. 求微分方程初值问题的符号解，并与数值解进行比较。
y = dsolve('x^2*D2y-x*Dy+y-x*log(x)','y(1)=1,Dy(1)=1','x');
数值解参考P157.

%%%%%%%%
思考练习
%%%%%%%%
一、填空题
1.表达式1+1/2的值是（1.5），表达式1+1/sym(2)的值是（3/2）。
2.略。
3.在命令行窗口输入下列命令：
>> f = sym(1);
>> eval(int(f,1,4))  % int(f,1,4)的结果是表达式，eval()是评估该表达式的值
则命令执行后s的值是（3）。
4.略。
5.略。
6.MATLAB用于符号计算的常用可视化分析工具有（funtool）和（Taylor tool）。

二、问答题
1. eval(): 符号表达式 --> 数值结果

2. 化简表达式。
1）2*cos(x)^2-sin(x)^2
sym x;
simplify(2*cos(x)^2-sin(x)^2)---> 2-3*sin(x)^2
2）~4）略。

3.求函数的极限。
1）syms x; 
   f = abs(x)/x;
   res = limit(f,x,0,'left');  % -1
4.求函数的导数。
1）y = sqrt(x+sqrt(x+sqrt(x)));
   syms x;
   diff(y,x,1);
   diff(y,x,2);

5.求不定积分。
1）syms x; I = int(1/sin(x));

6.用数值计算与符号计算求给定函数的定积分。
1）I = integral(@(x)1+sqrt(x),0,4);  %数值解：9.333
   syms x;
   I_hat = int(1+sqrt(x),0,4);       %符号解：28/3 (精确解)

7.求下列级数之和。
1）syms n; res = symcum(1/(4^n),1,inf);   % 1/3

8.略。

9.求非线性方程的符号解。
1）ln(1+x)-5/(1+sin(x)) = 2
syms x;
res = solve(log(1+x)-5/(1+sin(x))-2==0,x); 

2）
syms x y z;
eq1 = 4*x^2/(4*x^2+1)==y;
eq2 = 4*y^2/(4*y^2+1)==z;
eq3 = 4*z^2/(4*z^2+1)==x;
[x,y,z] = solve([eq1,eq2,eq3],[x,y,z]);
 